---
title: "Introducci√≥n al An√°lisis de Supervivencia"
editor: visual
author: 
  - name: Sergio M. Nava Mu√±oz
    id: sn
    email: nava@cimat.mx
    affiliation: 
        - id: cimat
          name: CIMAT
          city: Aguascalientes
          state: Ags
date: 2025-06-01
format: 
  revealjs:
    slide-number: true
    theme: simple
    fontsize: 1.5em
    css: style.css
    chalkboard: true
    menu: TRUE
    transition: slide
    background-transition: fade
    title-slide-attributes:
      data-background-size: 100% 100%;     
execute:
  echo: false
---


```{r}
packages <- c("survival","asaur")
if (length(setdiff(packages, rownames(installed.packages()))) > 0) {
  install.packages(setdiff(packages, rownames(installed.packages())), repos = "http://cran.rstudio.com")
}
```


# An√°lisis de Supervivencia

## Introducci√≥n y Objetivos

-   **Relevancia de la confiabilidad** en contextos biom√©dicos, industriales y econ√≥micos
-   **Objetivos de la sesi√≥n** (2 horas):
    -   Comprender conceptos clave: tiempo de falla, funciones de supervivencia y riesgo
    -   Mecanismos de censura y truncamiento
    -   Modelos de supervivencia b√°sicos y estimaci√≥n en R
    -   Aplicaciones pr√°cticas con ejemplos de datos reales

## Agenda

1.  Definici√≥n y ejemplos de tiempos de falla (20 min)
2.  Funci√≥n de supervivencia y funci√≥n de riesgo (30 min)
3.  Censura y truncamiento (20 min)
4.  Estimaci√≥n no param√©trica: Kaplan-Meier en R (30 min)
5.  Modelos param√©tricos y discusi√≥n de sistemas reparables (20 min)


## 1. ¬øQu√© es el an√°lisis de supervivencia? {.scrollable transition="slide"}

::: {.columns}
::: {.column width="55%"}

> **An√°lisis de Supervivencia**  
> es el an√°lisis estad√≠stico de **tiempos hasta la ocurrencia de un evento**.  
> Tambi√©n se conoce como an√°lisis de *time-to-event*.

M√°s precisamente, estudia el **tiempo transcurrido entre dos eventos**:  

- Un evento de **inicio**  
- Un evento de **fin**

:::

::: {.column width="45%"}
**S√≠mbolo usual**: $T$  
‚Üí Variable aleatoria no negativa que representa el tiempo hasta el evento.

**T√©rminos comunes**:

- Tiempo de falla
- Tiempo de vida
- Tiempo de supervivencia

:::
:::

---

## ¬øD√≥nde se aplica el an√°lisis de supervivencia? {transition="fade"}

### Aplicaciones comunes

- **Biom√©dicas**  
  - Tiempo hasta reca√≠da, muerte, recuperaci√≥n o aparici√≥n de una enfermedad.
- **Industriales**  
  - Duraci√≥n de dispositivos, tiempo hasta la primera falla.
- **Econ√≥micas / financieras**  
  - Tiempo en desempleo, tiempo hasta bancarrota, duraci√≥n de relaciones laborales.

**Nota**: El "tiempo" puede medirse en d√≠as, semanas, kil√≥metros, horas de operaci√≥n, etc.

---

## Naturaleza de los datos de supervivencia {transition="slide"}

- Los datos de tiempo a evento son realizaciones de **variables aleatorias no negativas**.
- Pueden ser:
  - **Continuos**: como tiempo en d√≠as, semanas, horas.
  - **Discretos**: como n√∫mero de visitas o ciclos.

**Ejemplo de variable de inter√©s**:  
$$
T = \text{Tiempo entre el ingreso al hospital y la recuperaci√≥n}
$$

---

## ¬øQu√© se necesita definir para analizar tiempos de falla? {transition="slide"}

Para interpretar adecuadamente los datos, es necesario:

### 1. Evento de origen  
‚Üí ¬øDesde cu√°ndo empieza a contarse el tiempo?

### 2. Escala de medici√≥n  
‚Üí ¬øC√≥mo se mide el tiempo? (reloj, kil√≥metros, ciclos)

### 3. Evento de fin  
‚Üí ¬øQu√© se considera "fallo", "recuperaci√≥n", o "evento"?

---

## Ejemplos pr√°cticos {.smaller transition="fade"}

**Ejemplo biom√©dico ‚Äì Ensayo cl√≠nico**:

- Evento de origen: entrada del paciente al estudio
- Evento de fin: muerte o recuperaci√≥n
- Escala: tiempo en semanas

**Ejemplo industrial ‚Äì Billetes**:

- Evento de origen: salida a circulaci√≥n
- Evento de fin: destrucci√≥n por deterioro
- Escala: tiempo calendario o n√∫mero de transacciones

**Ejemplo financiero ‚Äì Desempleo**:

- Evento de origen: p√©rdida de empleo
- Evento de fin: contrataci√≥n nueva
- Escala: meses sin empleo

---

## Ejemplos de datos de supervivencia {.smaller .scrollable transition="slide"}

A continuaci√≥n se presentan algunos ejemplos de datos de supervivencia. Estos ejemplos fueron obtenidos de Klein & Moeshberger (1997).

### Ejemplo de Duraci√≥n de la remisi√≥n en un ensayo cl√≠nico para leucemia aguda

> Duraci√≥n de remisi√≥n de un ensayo cl√≠nico para leucemia aguda. Resultados de un ensayo cl√≠nico en donde se quer√≠a compara la efectividad de la droga $6-MP$ versus placebo en 42 ni√±os con leucemia aguda. El evento de inicio es remisi√≥n parcial de la enfermedad despu√©s de haber sido tratados con la droga prednisone. El evento de fin es reca√≠da o muerte. La escala de medici√≥n es tiempo calendario en meses. Algunos individuos no presentaron el evento de fin al t√©rmino del estudio. Estos casos son marcados con un + y son llamados censurados por la derecha. M√°s adelante los veremos con detalle.

![](figura/ejemp1.png){width="40%" fig-align="center"}

---


### Ejemplo de Transplante de m√©dula √≥sea en pacientes con leucemia. 

::: {.smaller .scrollable transition="slide"}


> Transplante de m√©dula es un procedimiento est√°ndar en pacientes con leucemia aguda. La recuperaci√≥n despu√©s del transplante es un proceso complejo. La prognosis para la recuperaci√≥n puede depender de factores que se conocen al momento del transplante, como edad y sexo del paciente y donador, etapa de la enfermedad inicial, tiempo entre el diagn√≥stico y el transplante, etc. La prognosis final depende de c√≥mo evoluciona el paciente despu√©s del transplante. Puede generar aversi√≥n o rechazo de la medula transplantada (GVHD), que el conteo de plaquetas se vuelva normal o desarrollar infecciones, etc. El transplante se considera fracaso cuando el paciente recae o muere.

![](figura/ejemp2.png){width="40%" fig-align="center"}

:::

------


### Ejemplo de Transplante de m√©dula √≥sea en pacientes con leucemia.  (cont.)


::: {#ejemp-2 layout-ncol="2"}
![](figura/ejemp2-3.jpg){width="100%" fig-align="center"}

![](figura/ejemp2-2.jpg){width="100%" fig-align="center"}

:::

-----

### Ejemplo Tiempos de muerte de adultos mayores residentes de un asilo.


::: {.smaller .scrollable transition="slide"}


> Channing House es una casa de retiro en California. Datos con las edades de muerte de 462 individuos (97 hombres y 365 mujeres) que estuvieron en la residencia durante el periodo de enero de 1964 y julio de 1975. Se report√≥ la edad a la muerte o al momento en que se sal√≠an del asilo (en meses) y la edad a la que los individuos entraron al asilo. Estos datos son un ejemplo de truncamiento por la izquierda que m√°s adelante veremos con detalle. Un individuo tiene que sobrevivir lo suficiente para estar en edad de entrar al asilo. Individuos que mueren previamente a la edad de retiro son excluidos del estudio.

![](figura/ejemp3.png){fig-align="center" width="40%"}

:::

-----

### Ejemplo Tiempo al primer uso de marihuana.


::: {.smaller .scrollable transition="slide"}


> En este estudio a 191 estudiantes de preparatoria se les pregunt√≥: ¬øCu√°l fue la primera vez que probaste la marihuana?. Las respuestas fueron, ‚Äúla edad exacta a la que la probaron‚Äù, ‚Äúnunca la he probado‚Äù, y ‚Äúla prob√© pero no recuerdo cuando fue la primera vez‚Äù. En este √∫ltimo caso tenemos una censura por la izquierda. El evento de inter√©s ha ocurrido en alg√∫n momento previo a la edad actual del estudiante!.

![](figura/ejemp4.jpg){fig-align="center" width="5in"}

:::

-----

### Tiempo a desarrollar sida.


::: {.smaller .scrollable transition="slide"}


> Se reportan datos con tiempos de infecci√≥n y de inducci√≥n para 258 adultos y 37 ni√±os que fueron infectados con el virus del VIH y desarrollaron sida antes del 30 de junio de 1986. Los datos consisten de los tiempos (en a√±os) desde que adultos fueron infectados por el virus por transfusi√≥n de sangre contaminada, y el tiempo de espera hasta el desarrollo de sida. Para la poblaci√≥n pedi√°trica, los ni√±os fueron infectados en √∫tero o al nacer. El tiempo base de medici√≥n es el 1 de abril de 1978. En este estudio, s√≥lo los individuos que han desarrollado sida antes del t√©rmino del estudio son considerados. Individuos que no han desarrollado sida no son incluidos en el estudio. Este tipo de datos es llamado truncados por la derecha y m√°s adelante los veremos con detalle.

### Tiempo de inducci√≥n de SIDA en adultos y ni√±os

| Infection Time | Adult Induction Time                     | Child Induction Time   |
|----------------|------------------------------------------|-------------------------|
| 0.00           | 5                                        |                         |
| 0.25           | 6.75                                     |                         |
| 0.75           | 5, 5, 7.25                               |                         |
| 1.00           | 4.25, 5.75, 6.25, 6.5                    | 5.5                     |
| 1.25           | 4, 4.25, 4.75, 5.75                      |                         |
| 1.50           | 2.75, 3.75, 5, 5.5, 6.5                  | 2.25                    |
| 1.75           | 2.75, 3, 5.25, 5.25                      |                         |
| 2.00           | 2.25, 3, 4, 4.5, 4.75, 5, ...            |                         |
| 2.25           | 3, 5.5                                   | 3                       |
| 2.50           | 2.25, 2.25, ..., 4                       |                         |
| 2.75           | 1.25, 1.5, ..., 5.25                     | 1                       |
| 3.00           | 2, 3.25, ..., 5                          | 1.75                    |
| 3.25           | 1.25, 1.75, ..., 4.5                     |                         |
| 3.50           | 1.25, 2.25, ..., 4.5                     | 0.75                    |
| 3.75           | 1.25, 1.75, ..., 4.25                    | 0.75, 1, ..., 4.25      |
| 4.00           | 1, 1.5, ..., 4                           | 1                       |
| 4.25           | 1.25, 1.5, ..., 3.5                      | 1.75                    |
| 4.50           | 1, 1.5, ..., 3.25                        | 3.25                    |
| 4.75           | 1, 1.5, ..., 3.25                        | 1, 2.25                 |
| 5.00           | 0.5, 1.5, ..., 3                         | 0.5, 0.75, 1.5, 2.5     |
| 5.25           | 0.25, 0.25, ..., 2.75                    | 0.25, 1, 1.5            |
| 5.50           | 1, 1, ..., 2.5                           | 0.5, 1.5, 2.5           |
| 5.75           | 0.25, 0.75, ..., 2.25                    | 1.75                    |
| 6.00           | 0.5, 0.75, ..., 2                        | 0.5, 1.25               |
| 6.25           | 0.75, 1, ..., 1.75                       | 0.5, 1.25               |
| 6.50           | 0.25, 0.25, ..., 1.5                     | 0.75                    |
| 6.75           | 0.75, 0.75, ..., 1.25                    | 0.5, 0.75               |
| 7.00           | 0.75                                     | 0.75                    |
| 7.25           | 0.25                                     | 0.25                    |


:::

----

## Ejemplos de Datos de Supervivencia

```{r}
# Ejemplo simulado de tiempos de supervivencia
set.seed(123)
tiempos <- rexp(100, rate = 0.05)
status <- rbinom(100, 1, prob = 0.8)
library(survival)
data_sim <- data.frame(time = tiempos, event = status)
```

::: smaller
```{r}
# Mostrar los primeros 10 registros con fuente m√°s peque√±a
knitr::kable(data_sim[1:8, ], caption = "Primeros 8 registros de data_sim")
```
:::

## 2. Funciones fundamentales en an√°lisis de supervivencia {.scrollable transition="slide"}

> En an√°lisis de supervivencia, las variables aleatorias de inter√©s $T$ son no negativas, y se caracterizan no solo por $f(t)$ o $F(t)$, sino tambi√©n por funciones **m√°s interpretables**:

- $S(t)$: funci√≥n de supervivencia
- $h(t)$: funci√≥n de riesgo o tasa de falla
- $H(t)$: riesgo acumulado

---

## Funci√≥n de Supervivencia {.scrollable transition="slide"}

> $S(t) = P(T > t) = 1 - F(t)$

Representa la probabilidad de **sobrevivir m√°s all√° del tiempo $t$**.

::: {.columns}
::: {.column width="50%"}

**Propiedades clave**:

- Mon√≥tona no creciente  
- $S(0) = 1$, $\lim_{t \to \infty} S(t) = 0$

:::
::: {.column width="50%"}
![](figura/Ss.jpg){fig-align="center" width="80%"}
:::
:::

---

## Funci√≥n de Riesgo {.scrollable transition="slide"}

> $h(t) = \frac{f(t)}{S(t)}$

- Tambi√©n conocida como:
  - Tasa de falla condicional (confiabilidad)
  - Tasa de mortalidad (demograf√≠a)
  - Funci√≥n de intensidad (procesos estoc√°sticos)

**Interpretaci√≥n**:  
Tasa instant√°nea de ocurrencia del evento, dado que se ha sobrevivido hasta $t$.

---

## Ejemplos de formas de riesgo {transition="slide"}

::: {.columns}
::: {.column width="50%"}

- Riesgo creciente ‚Üí envejecimiento
- Riesgo decreciente ‚Üí rejuvenecimiento
- Riesgo tipo ‚Äútina de ba√±o‚Äù ‚Üí mortalidad neonatal y senil
- Riesgo tipo ‚Äúmonta√±a‚Äù ‚Üí reca√≠da tras tratamiento

:::
::: {.column width="50%"}
![](figura/ejempRiesgoContinuo.jpg){fig-align="center" width="4in"}
:::
:::

---

## Otra forma de visualizaci√≥n {transition="fade"}
![](figura/ejempRiesgoContinuo2.jpg){fig-align="center" width="4in"}

---

## Riesgo en tiempo discreto {.scrollable transition="slide"}

Para $T$ discreta con soporte $\{u_1, u_2, \dots\}$:

$$
h(t) = P(T = t \mid T \ge t)
$$

$$
h_k = \frac{P(T = u_k)}{P(T \ge u_k)} = \frac{f(u_k)}{S(u_{k-1})}
$$

Usando $f(u_k) = S(u_{k-1}) - S(u_k)$, se obtiene:

$$
h_k = 1 - \frac{S(u_k)}{S(u_{k-1})}
$$

---

## Relaciones discretas clave {.scrollable transition="slide"}

Funci√≥n de supervivencia:

$$
S(t) = \prod_{u_k \le t} (1 - h_k)
$$

Funci√≥n de densidad:

$$
f(u_j) = h_j \prod_{k<j} (1 - h_k)
$$

> En demograf√≠a, $h(t)$ representa la probabilidad de morir en el momento $t$ dado que se ha sobrevivido hasta $t$.

---

## Ejemplos de riesgo discreto {transition="fade"}

![](figura/ejempRiesgoDiscreto.jpg){fig-align="center" width="4in"}

---

## Riesgo acumulado discreto {.scrollable transition="slide"}

Dos definiciones equivalentes:

1. Suma directa:
$$
H(t) = \sum_{u_k \le t} h_k
$$

2. Log-transformaci√≥n:
$$
H(t) = - \sum_{u_k \le t} \log(1 - h_k)
$$

Ambas son **mon√≥tonas no decrecientes**.

---

## Riesgo en tiempo continuo {.scrollable transition="slide"}

$$
h(t) = \lim_{\varepsilon \to 0} \frac{1}{\varepsilon} P(t < T \le t + \varepsilon \mid T \ge t)
= \frac{f(t)}{S(t)}
$$

Como $F(t) = 1 - S(t)$, entonces:

$$
h(t) = -\frac{d}{dt} \log S(t)
$$

Al integrar:

$$
\log S(t) = -\int_0^t h(u) \, du
$$

$$
S(t) = \exp\left(-\int_0^t h(u) \, du\right)
$$

> $h(t)\varepsilon$ es la probabilidad **aproximada** de que un evento ocurra en el siguiente instante dado que el individuo ha sobrevivido hasta $t$.

---

## Riesgo acumulado continuo {transition="slide"}

$$
H(t) = \int_0^t h(u)\, du
\qquad\Rightarrow\qquad
S(t) = \exp\{-H(t)\}
$$

Si $S(\infty) = 0$, entonces $H(\infty) = \infty$.

---

## Visualizaci√≥n de funciones {.scrollable transition="fade"}

![](figura/Funciones1.png){fig-align="center"}
![](figura/Funciones2.png){fig-align="center"}


## Censura y truncamiento {#sec-censura-y-truncamiento .scrollable transition="slide"}

::: {.columns}

::: {.column width="50%"}

### ¬øQu√© es la **censura**?

- La **censura** ocurre cuando **no se observa completamente** el tiempo de fallo.
- Es com√∫n en estudios longitudinales, donde algunos individuos:
  - **No han fallado** al final del estudio,
  - **Ingresan tarde** al seguimiento,
  - O **se pierde el seguimiento**.

**Tipos de censura**:

-  **Por la derecha**: solo sabemos que el evento ocurri√≥ despu√©s de cierto tiempo.
-  **Por la izquierda**: solo sabemos que ocurri√≥ antes de cierto tiempo.
-  **Por intervalo**: solo sabemos que ocurri√≥ entre dos tiempos.

:::

::: {.column width="50%"}

### ¬øQu√© es el **truncamiento**?

- El **truncamiento** ocurre cuando **ciertas observaciones nunca se registran** debido al dise√±o del estudio.

**Ejemplos**:

- **Truncamiento por la izquierda**: s√≥lo se incluyen individuos cuyo evento ocurre **despu√©s** de cierto punto.
- **Truncamiento por la derecha**: se excluyen individuos cuyo evento ocurre **despu√©s** de cierto punto.

**Implicaci√≥n**:

- Afecta **qui√©n entra al estudio** (selecci√≥n), no solo c√≥mo se mide el tiempo.

:::
:::

---

### üîç Notas para el instructor:

- Puedes acompa√±ar esta diapositiva con una **gr√°fica tipo l√≠nea de tiempo** que contraste **censura** vs **truncamiento** (e.g. tipo Klein & Moeschberger).
- Si se quiere profundizar, a√±ade en otra diapositiva c√≥mo **afectan a la funci√≥n de verosimilitud**.
- Si el p√∫blico es nuevo en supervivencia, considera ilustrar con ejemplos cotidianos:
  - Censura: ‚Äúno sabemos cu√°ndo muri√≥ un paciente, solo que estaba vivo al final del estudio‚Äù.
  - Truncamiento: ‚Äúpersonas que murieron antes de entrar al estudio no est√°n en el conjunto de datos‚Äù.



## Tipos de censura por la derecha {.scrollable transition="slide"}

### ¬øC√≥mo se genera la censura?

En estudios de supervivencia, es com√∫n que **no se observe completamente** el tiempo de falla. Esto ocurre mediante distintos mecanismos:

- **Censura tipo I**
- **Censura tipo II**
- **Censura aleatoria**

---

## Censura tipo I {.smaller transition="slide"}

::: {.columns}
::: {.column width="55%"}

**Definici√≥n**:  
Se observa el tiempo de supervivencia $T_i$ **solo si ocurre antes de un tiempo de censura predeterminado** $C_i$.  
Si $T_i > C_i$, entonces el dato est√° censurado.

**Notaci√≥n formal**:

- Observamos el par $(t_i, \delta_i)$, donde  
  - $t_i = \min(T_i, C_i)$  
  - $\delta_i = I(T_i \le C_i)$  
- Si $\delta_i = 1$: observaci√≥n completa  
- Si $\delta_i = 0$: censura por la derecha

:::

::: {.column width="45%"}
![](figura/CensuraI.jpg){fig-align="center" width="90%"}
:::
:::

---

### Ejemplo de censura tipo I {.smaller}

> En un estudio toxicol√≥gico, ratones reciben un carcin√≥geno.  
> Se observa su supervivencia hasta cierto tiempo l√≠mite.  
> Los ratones a√∫n vivos en ese punto son sacrificados (censurados).

**Importante**: Puede haber **m√∫ltiples tiempos de censura**, dependiendo del dise√±o experimental.

![](figura/CensuraI-3.jpg){fig-align="center" width="75%"}

---

### Censura tipo I generalizada {.smaller}

> Cada individuo entra en un momento distinto al estudio, pero el final del estudio est√° predeterminado.

- Cada sujeto tiene su propio tiempo de censura fijo.
- Este dise√±o genera **censura tipo I generalizada**.

![](figura/CensuraI-2.jpg){fig-align="center" width="75%"}

---

## Censura tipo II {transition="slide"}

::: {.columns}
::: {.column width="55%"}

**Definici√≥n**:  
El estudio se **detiene al observar la falla de los primeros $r < n$ sujetos**.

- Se observan los tiempos $T_{(1)}, T_{(2)}, \dots, T_{(r)}$
- Los $n - r$ sujetos restantes est√°n censurados.

**Notaci√≥n**:

- Tiempo de censura com√∫n: $C = T_{(r)}$
- Censura si $T_i > C$

:::

::: {.column width="45%"}
_Aplicaci√≥n t√≠pica_: pruebas de resistencia de equipos que se detienen al fallar cierto n√∫mero de unidades.

_Ejemplo_: Se prueban 20 motores, pero se termina el estudio tras la falla de los primeros 10.


:::
:::

---

## Censura aleatoria {transition="slide"}

::: {.columns}
::: {.column width="55%"}

**Definici√≥n**:  
El tiempo de censura $C_i$ es una **variable aleatoria**, diferente para cada individuo.

**Ejemplos comunes**:

- Salida del estudio
- Muerte por otra causa
- Migraci√≥n o p√©rdida de contacto
- Hospital deja de aceptar al paciente

:::

::: {.column width="45%"}
_Ejemplo aplicado_:  
En estudios con pacientes de di√°lisis,  el evento de inter√©s puede ser fallas por infecci√≥n,  pero se censura por muerte o salida del hospital.

:::
:::



### Tipos de censura aleatoria

- **No informativa**: $C_i \perp T_i$  
  ‚Üí tratable como censura tipo I
- **Informativa**: $C_i$ depende de $T_i$  
  ‚Üí requiere modelos avanzados

---

## Conclusi√≥n {transition="fade"}

- La **censura por la derecha** se clasifica seg√∫n su origen: planificado, condicional o aleatorio.
- Es fundamental para construir correctamente la **funci√≥n de verosimilitud**.
- Un mal manejo de la censura puede sesgar estimaciones.


## Censura por la izquierda e intervalo {.smaller .scrollable transition="slide"}

### ¬øQu√© es la censura por la izquierda?

::: {.columns}
::: {.column width="55%"}

- Ocurre cuando **el evento de inter√©s sucede antes de un tiempo de observaci√≥n conocido**.
- Es decir, **sabemos que el evento ya ocurri√≥**, pero **no cu√°ndo exactamente**.

**Definici√≥n formal**:  
Sea $C_l$ el tiempo de censura por la izquierda y $T_i$ el tiempo de falla.

- Si $T_i \ge C_l$: observaci√≥n completa.  
- Si $T_i < C_l$: **censura por la izquierda**.

**Notaci√≥n**:  
$$
t_i = \max(T_i, C_l), \quad 
\delta_i = I(T_i \ge C_l)
$$

:::

::: {.column width="45%"}
**Ejemplo 1**  

> Adolescente declara:  
> _‚ÄúS√≠ consum√≠ marihuana, pero no recuerdo cu√°ndo‚Äù._  
> ‚Üí El evento ocurri√≥ antes de su edad actual, pero se desconoce el momento exacto.

**Ejemplo 2**  

> Un ni√±o ya sabe realizar una tarea cuando entra al estudio.  
> ‚Üí El aprendizaje ocurri√≥ antes de la observaci√≥n inicial.

:::
:::

---

## Censura doble (izquierda y derecha) {.smaller transition="slide"}

::: {.columns}
::: {.column width="60%"}

**Definici√≥n**:  
Una observaci√≥n est√° **doblemente censurada** si se desconoce si el evento ocurri√≥ antes o despu√©s de un cierto rango.

- Combina censura por la izquierda y la derecha.
- Com√∫n en estudios transversales o con l√≠mites temporales de observaci√≥n.

**Notaci√≥n generalizada**:

$$
t_i = \max\{ \min(T_i, C_r), C_l \}, \quad
\delta_i =
\begin{cases}
1, & \text{tiempo exacto} \\
0, & \text{censura por la derecha} \\
-1, & \text{censura por la izquierda}
\end{cases}
$$

:::

::: {.column width="40%"}

**Ejemplo 1 ‚Äì Marihuana**  

> ‚ÄúNunca la he usado‚Äù ‚Üí censura por la derecha  
> ‚ÄúS√≠ la us√© pero no recuerdo cu√°ndo‚Äù ‚Üí izquierda  
> ‚ÄúLa us√© a los 15‚Äù ‚Üí observaci√≥n completa

**Ejemplo 2 ‚Äì Aprendizaje infantil**  

> Algunos ni√±os no aprenden durante el estudio ‚Üí censura por la derecha  
> Otros ya sab√≠an antes de iniciar ‚Üí censura por la izquierda

:::
:::

---

## Comparaci√≥n gr√°fica sugerida {transition="none"}

(Agregar una figura como la siguiente para reforzar visualmente)

| Tipo de observaci√≥n      | L√≠nea de tiempo                       |
|--------------------------|----------------------------------------|
| **Exacta**               | Evento ocurre entre observaci√≥n inicial y final |
| **Censura por la derecha** | L√≠nea que termina sin evento registrado |
| **Censura por la izquierda** | L√≠nea que empieza con evento ya ocurrido |
| **Doble censura**        | Solo se sabe que el evento ocurri√≥ fuera del intervalo de observaci√≥n |

---

## Recomendaciones {.smaller}

- Identificar con claridad el **momento de entrada** al estudio y el **horizonte de observaci√≥n**.
- Siempre registrar **si se trata de censura por la izquierda, derecha o ambas**.
- Verificar si la censura es **informativa o no informativa**.




## Censura por intervalo {.scrollable transition="slide"}

### ¬øQu√© es la censura por intervalo?

::: {.columns}
::: {.column width="55%"}

- La **censura por intervalo** ocurre cuando **el evento sucede entre dos visitas cl√≠nicas**, pero **no se conoce el momento exacto**.

**Interpretaci√≥n**:  
Se sabe que el sujeto **no hab√≠a fallado antes del tiempo $L_i$**, pero s√≠ **lo ha hecho antes o en el tiempo $R_i$**.

**Notaci√≥n formal**:

$$
L_i < T_i \le R_i
$$

Donde:

- $L_i$ = √∫ltima vez que se observ√≥ sin evento  
- $R_i$ = primera vez que se detecta el evento

:::

::: {.column width="45%"}
Puedes pensar esta censura como una observaci√≥n **con ventana de tiempo**, en la que el evento ocurre **dentro de un intervalo** que puede variar por sujeto.

Posibles causas:

- Visitas cl√≠nicas programadas
- Limitaciones de seguimiento continuo
:::
:::
---

### Ejemplo 1 ‚Äì Estudio del Coraz√≥n de Framingham {.smaller}

> En este estudio longitudinal, los eventos de enfermedad coronaria (CHD) pueden registrarse con precisi√≥n.

Sin embargo:

- La aparici√≥n de **angina de pecho** se detecta solo **entre dos visitas cl√≠nicas**, con varios a√±os de diferencia.

‚Üí El tiempo exacto es desconocido, pero **ocurri√≥ dentro del intervalo** entre ex√°menes.

---

### Ejemplo 2 ‚Äì Estudio de radioterapia {.smaller}

> Se estudi√≥ el efecto cosm√©tico en mujeres con c√°ncer de mama tras radioterapia (con o sin quimioterapia).

- Se realizaron controles **cada 4 a 6 meses**, luego m√°s espaciados.
- El evento de inter√©s: **retracci√≥n severa del seno**.
- Solo se sab√≠a si **ocurri√≥ entre dos visitas**, o si **nunca se observ√≥** (censura por la derecha).

‚Üí Algunas pacientes presentaron **censura por intervalo**, y otras, **por la derecha**.

---

## Consideraciones finales {.smaller}

- La censura por intervalo requiere un tratamiento especial en modelos de supervivencia:  
  - No puede tratarse como observaci√≥n exacta ni como censura por la derecha.
- M√©todos como **EM**, modelos de **verosimilitud para intervalos**, o an√°lisis de **datos agrupados** son apropiados.


## Truncamiento {.scrollable .smaller transition="slide"}

### ¬øQu√© es el truncamiento?

::: {.columns}
::: {.column width="55%"}

- El **truncamiento** ocurre cuando **ciertos individuos no aparecen en el estudio**, porque **su tiempo de falla est√° fuera de una ventana de observaci√≥n**.

**Diferencia clave con la censura**:

- **Censura** ‚Üí se observa parcialmente
- **Truncamiento** ‚Üí **no se observa en absoluto**

**Definici√≥n formal**:  
Se observa $T_i$ **solo si** $T_i \in (U_i, V_i)$

:::

::: {.column width="45%"}
_Imaginemos una ventana de observaci√≥n:_  
Si el evento ocurre **antes** de entrar a la ventana o **despu√©s de que cierra**, el sujeto **no entra al estudio**.

Esto es **truncamiento**, no censura.

:::
:::

---

## Truncamiento por la izquierda {transition="slide"}

::: {.columns}
::: {.column width="55%"}

**Definici√≥n**:  
Solo se observan individuos cuyo tiempo de evento **supera un umbral inferior**:  
$$
T_i > U_i
$$

Tambi√©n conocido como **entrada retardada**: el sujeto **debi√≥ sobrevivir** lo suficiente para entrar al estudio.

:::

::: {.column width="45%"}

> **Ejemplo ‚Äì Centro de retiro**  
> En Channing House, solo se estudian residentes que **lograron ingresar**.  
> Quienes murieron **antes** de tener edad para ingresar, **no aparecen** en el estudio.  
> ‚Üí **Truncamiento por la izquierda**

:::
:::

---

## Truncamiento por la derecha {transition="slide"}

::: {.columns}
::: {.column width="55%"}

**Definici√≥n**:  
Solo se incluyen sujetos cuyo evento ocurre **antes de un umbral superior**:
$$
T_i < V_i
$$

Esto puede ocurrir en **estudios retrospectivos con fecha de corte**.

:::

::: {.column width="45%"}

> **Ejemplo ‚Äì Estudio del SIDA**  
> Solo se incluyen pacientes que desarrollaron SIDA **antes del 30 de junio de 1986**.  
> Aquellos cuya enfermedad apareci√≥ despu√©s, **no fueron observados**.  
> ‚Üí **Truncamiento por la derecha**

:::
:::

---

## Truncamiento y censura combinados {transition="fade"}

- Es **com√∫n** que los estudios de supervivencia combinen:
  - **Truncamiento por la izquierda** (entrada tard√≠a)
  - **Censura por la derecha** (seguimiento limitado)

- Ejemplo t√≠pico:  

  > Un paciente entra al estudio tras cumplir ciertos criterios (truncamiento),  
  > pero el estudio termina antes de que fallezca (censura).

---

## Visualizaci√≥n sugerida {transition="none"}

(Agregar figura con l√≠neas de tiempo para comparar:)

| Tipo de situaci√≥n           | L√≠nea de tiempo                      |
|----------------------------|---------------------------------------|
| **Truncamiento por izquierda** | Evento ocurre antes de entrada: no se observa |
| **Truncamiento por derecha**   | Evento ocurre despu√©s de fecha l√≠mite: no se observa |
| **Censura por derecha**        | Evento ocurre despu√©s de seguimiento: s√≠ se observa parcialmente |
| **Observaci√≥n completa**       | Evento ocurre dentro del periodo: s√≠ se observa |


## Visualizaci√≥n de Funciones en R

```{r}
# Estimaci√≥n Kaplan-Meier
km_fit <- survfit(Surv(time, event) ~ 1, data = data_sim)
plot(km_fit, xlab = "Tiempo", ylab = "Supervivencia", main = "Curva Kaplan-Meier")
```

## 3. Censura y Truncamiento

-   Censura por la derecha, izquierda e intervalos
-   Truncamiento (izquierdo/ derecho)
-   Impacto en el an√°lisis de supervivencia

## Ejemplo de Censura por la Derecha

```{r}
# Introducir censura artificial
cens <- ifelse(tiempos > 20, 0, status)
data_cens <- data.frame(time = pmin(tiempos, 20), event = cens)
km_fit2 <- survfit(Surv(time, event) ~ 1, data = data_cens)
plot(km_fit2, xlab = "Tiempo", ylab = "Supervivencia", main = "Kaplan-Meier con Censura")
```

## 4. Modelos Param√©tricos B√°sicos

-   Distribuciones exponencial, Weibull, log-log√≠stico
-   Ajuste de modelos en R

## Ajuste de Modelo Exponecial y Weibull

```{r}
# Modelo Exponencial
exp_fit <- survreg(Surv(time, event) ~ 1, data = data_sim, dist = "exponential")
# Modelo Weibull
weib_fit <- survreg(Surv(time, event) ~ 1, data = data_sim, dist = "weibull")
summary(exp_fit)
summary(weib_fit)
```

## 5. Sistemas Reparables y Discusi√≥n

-   Distinci√≥n entre sistemas reparables y no reparables
-   Modelos de procesos de fallas (NHPP, HPP)
-   Aplicaciones en mantenimiento y confiabilidad industrial

## Conclusiones y Material Adicional

-   Repaso de conceptos vistos
-   Lecturas recomendadas y recursos en l√≠nea
-   Pr√≥ximos pasos: modelado avanzado y an√°lisis multivariado
